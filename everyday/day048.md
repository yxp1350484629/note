# day048

1.高内聚：模块功能尽可能单一，不掺杂其他功能

低耦合：模块之间尽可能减少关联和影响

OSI七层模型

1.应用层：类似于qq等应用

2.表示层：提供将数据压缩，解密的功能，数据在内部是如何表示的

3.会话层：给应用之间建立连接，让他们可以传输数据

4.传输层：能够提供不同的传输服务，文字，图片，视频等

5.网络层：前面的会话只是建立连接，需要网络层通过网络处理的数据来传输

6.链路层：进行数据转化，将前面传过来的数据真正变成底层数据

7.物理层：物理硬件，将数据变为电路传输

5，6，7为网络底层

OSI七层模型的优点

1.减少耦合度，每一层可以独立开发，独立工作

2.提供了标准化的工作流程

TCP|IP模型就是将前三层称为应用层，链路层和物理层合起来为链路层，加上中间三层，共四层

重点：

   **应用层协议**：在[网络版加法计算器](https://blog.csdn.net/Lycorisradiata__/article/details/80556519)一文中，我们介绍的实现网络版本的加法计算器有两种方法。其实无论是哪种方法，只要能够保证，一端发送时构造的数据，另一端能够正确的解析，就是ok的，这种约定就是应用层协议。 

 所以，**http协议是应用层协议，它基于TCP协议进行可靠的传送。**HTTP协议定义了浏览器（万维网客户进程）以什么样的格式向万维网服务进程请求万维网文档，以及服务器以什么样的格式将文档传送给客户程序。 

最初的http协议只是用来浏览静态文件的，无状态协议已经足够，这样实现的负担也很轻（相对来说，实现有状态的代价是很高的，要维护状态，根据状态来操作。）。随着web的发展，它需要变得有状态，但是不是就要修改http协议使之有状态呢？是不需要的。因为我们经常长时间逗留在某一个网页，然后才进入到另一个网页，如果在这两个页面之间维持状态，代价是很高的。其次，历史让http无状态，但是现在对http提出了新的要求，按照软件领域的通常做法是，保留历史经验，在http协议上再加上一层实现我们的目的（“再加上一层，你可以做任何事”）。所以引入了其他机制来实现这种有状态的连接。 

HTTP是无状态的 也就是说，浏览器和服务器每进行一次HTTP操作，就建立一次连接，但任务结束就中断连接。如果客户端浏览器访问的某个HTML或其他类型的 Web页中包含有其他的Web资源，如JavaScript文件、图像文件、CSS文件等；当浏览器每遇到这样一个Web资源，就会建立一个HTTP会话 HTTP1.1和HTTP1.0相比较而言，最大的区别就是增加了持久连接支持(貌似最新的 http1.0 可以显示的指定 keep-alive),但还是无状态的，或者说是不可以信任的。 如果浏览器或者服务器在其头信息加入了这行代码 Connection:keep-alive TCP连接在发送后将仍然保持打开状态，于是，浏览器可以继续通过相同的连接发送请求。保持连接节省了为每个请求建立新连接所需的时间，还节约了带宽。 实现长连接要客户端和服务端都支持长连接。 所谓长连接指建立SOCKET连接后不管是否使用都保持连接，但安全性较差， 所谓短连接指建立SOCKET连接后发送后接收完数据后马上断开连接，一般银行都使用短连接 

HTTP协议在应用层，它只是规定双方应用的数据格式，要进行双方应用的连接还是基于TCP协议进行连接

对于HTTP 1.0的http标准而言，默认连接是短连接，啥叫短连接？就是服务器当发送完最后一个字节的数据之后将关闭连接，也就是回收tcp_sock结构，这样，如果客户端再发送数据给服务器，将直接丢弃。即使此时客户端还有这样的结构，但是我们说连接已经关闭或者已经断了。 
那客户端知不知道啥时候服务器的连接关闭？不知道，双方可以在任何时候来关闭自己的连接而没有必要通知对方。不过，对于短连接而言，通知不通知也没有意义了。

那短连接的弊端，大家可能都已经知道了，如果对一个服务器要连续发送多个请求，还需要为每次请求建立新的连接。

为了降低建立连接的时间，HTTP 1.1引入了长连接的概念，并把它搞成了默认的连接方式。啥叫长连接？就是当完成一个业务之后，socket结构并不回收。这样，只要在socket结构还存在的时候，客户端发送的任何数据，服务器都可以收到，这就是所谓的长连接。

相比短连接而言，长连接并没有什么特别的新的技术，只是维护socket结构时间长了。因为，说http长连接更不如说是tcp长连接。

可参考<https://www.jianshu.com/p/27a79e38274a> 

<https://www.cnblogs.com/bellkosmos/p/5237146.html> 

<https://www.jianshu.com/p/1d39fd9f1917> 

2.网络主机：在网络中标识一台计算机 HOST

本地使用 'localhost' '127.0.0.1' 本地测试ip

网络使用 '0.0.0.0' 会自动选择合适的网络主机

在 linux系统下查看当前计算机的ip信息  ifconfig

ip地址就是在网络中标识 一台主机的地址

3.公网的IP是唯一的，但是公网下面的私网，局域网IP地址不唯一

通过ping ip可以测试自己ip与这个ip是否联通

4.域名就是网络服务器的名称比如ww.baidu.com,他输入在网页的效果和百度ip地址效果一样

实际输入域名，自动通过dns协议，进行解析转化为ip地址

5.一个主机的ip地址下有多个网络端口号，用以表示不同的软件地址

端口号取值返回1-65535

1-255一些通用标识端口

256-1023 操作系统应用端口

1024-65535 通用端口   但是数据库端口3306在这里面

建议使用10000以上的端口

6.不同系统设备对于ip地址等解析不同

所以要引用网络字节序，也就是数据在网络中传输的标准格式

7.基于tcp协议的数据传输

面向连接的传输服务，重要的是可靠性

三次握手

1.客户端向服务器发送连接请求

2.服务器给予回应，看是否能够连接

3.客户端收到回应后，发送最终连接

这三次握手，都是通过发送消息包来实现数据传输的

四次挥手

注意数据断开是客户端服务器都能进行的

1.主动方发送请求：我想断开

2.被动方收到，回复已收到，准备断开

3.被动方准备就绪后，发送消息确认可以断开

4.主动发发送最终断开消息

注意断开连接，被动方是需要一段时间准备的

注意基于tcp协议的数据连接适用于，不需要频繁链接，网络情况良好，不会时常断开，传输较大的文件或者对于可靠安全性较高的文件

比如邮件发送，网页获取，登陆注册，邮件发取

8.基于udp协议的数据传输

面向无连接的传输服务，不保证可靠性，没有连接断开的确认，数据传输自由，流畅

适用于网络情况较差，对于数据可靠性要求不高，传输频率高，需要提升传输效率。

比如视频，群聊