# day062(mongoDB)

1.删除函数

update(查找条件，修改成什么样，没筛选到的设置，修改多少的设置)

首先根据查找条件找到文档，然后根据第二个参数将文档改成什么样

第三个参数默认为false，是如果没有查询到文档，就什么也不显示，如果设置为True，会根据查找条件和修改成什么样插入一条新的文档

第四个参数默认为false，即使有很多满足条件的记录，但只修改第一条，若想全部修改，必须设置为True

第二个参数详解

第二个参数也是{}里的条件，这个条件都会用到修改符，一般是修改符在前，比如 {$set:{域名:值}} 

由于里面也是条件，{}和[]里面都能包含多个键值对，所以第二个参数也能放多个条件，这些条件都要用到修改器

常用修改符

$set  将根据第一个参数查找到的文档的某个域的值修改。根据第三个参数，可以设置未有满足条件的，是否插入数据。

当我们查找到满足条件的数据，但是$set设置的域名不存在，也会将这个域名插入到这个文档的后面，这个和第三个参数无关

$unset，将某个域名删除  {$unset:{域名:''} 设置为空字串就是删除了

$rename,将满足条件的文档的某个域改名 {$rename:{name:'ol'}}  这就将name域名改为了ol，注意这个要顾及第四个参数，因为第四个参数默认只能对一条进行操作,需要设置为true

$setOnInsert 用于条件中，一般接在$set的后面，只有当未查询到文档，需要根据第一个参数和第二个参数插入数据时，这个条件才会触发，也会插入$setOnInsert 中的数据

{$set:{name:'ol',$setOnInsert:{sex:'w',age:9}}}  在插入数据的时候也会插入sex和age

$inc 加法修改器，一般设置满足条件文档的某个域名值+n  参数可为正数负数 小数

$mul 乘法修改器 一般设置满足条件文档的某个域名值*n 参数可为正数负数 小数

$min 上限修改器 给满足条件的文档的某个域值设置上限，大于它，就设置为这个值

$max 下限修改器 给满足条件的文档的某个域值设置下限，小于它，就设置为这个值

用于数组的修改符

$push 添加一个值给数组 {$push:{数组域名:值}}

$pushAll 添加多个值给数组 {$pushAll:{数组域名:[值]}} 用[]包含多个值

$pull 从数组中删除一个值

$pullAll 删除多个值给数组 {$pushAll:{数组域名:[值]}} 用[]包含多个值

$pop是将数组的元素的首末弹出来，设置为1，和正常pop()一样弹出末尾，设置为-1弹出首个

$addToSet 和push一样往里面添加数据，如果数据不存在就添加，数据存在就不添加



$each操作符，是对自己给的所有数据进行操作，通常前面接$push,后面可以接其他操作符

比如 {$push:{score:{$each:[0个或多个数据]}} 代表将[]内所有数据添加到里面

虽然和pushAll区别不是很大

但是底层c++算法中却把$position和$sort和$each配套

就是对于数组操作的$position和$sort操作符，必须前面有$each

比如{$push:{score:{each:[0个或多个],position:1}}}这是将0个或多个数据插入到第二个位置

position后面接位置

还有 {$push:{score:{$each:[0个或多个],$sort:-1或1}}}  $each中给0个数据，就是直接把数组中的数据排序

$each中有数据，就是先插入数据，后排序。这是配套的，前面必须有$push，$each



2.时间类型数据

可以直接在插入数据的时候，在:用new Date()来插入当前时间，插入的时间是ISOmongo的标准时间类型

当然也可以用ISODate(),也是ISOmongo的标准时间类型。

我们要是想插入字符串类型的时间，可以用Date()来将系统时间转化为时间字符串

我们若是想插入一条我们指定的时间，若是想变成标准格式，可以用ISODate函数，比如ISODate('20170101 12:11:01')

时间戳函数，需要根据给出的日期来返回数值，一般接在标准时间的后面，接在ISODate后面

比如 ISODate().valueOf()



3.文档中的文档

就是:后再接一个文档，一般通过点记法访问，注意，由于底层是c++,只接受这个时候传参为字符，所以不能用域名.  必须加上双引号来表示字符串，不然无法识别。

文档和数组都可以用.记法来访问其中某一项，但是必须要加上双引号

文档访问，用'域名.内部文档'  数组用'域名.序列值'



