# day061(mongoDB2)

命令语句详解

1.查找语句

db.集合名.find(query,field) query指条件，相当于mysql中where部分，field指域相当于mysql中的select 后面要查找的字段。这两个参数都可以用键值对表示，意思大致于‘是，等于’的意思。用{}包围

query的使用用键值对，除了_id域以外，其余的域要么设置为0，要么设置为1.

设置为0,则表示，除了设置为0的这些域以外，其余的域值均显示，当然_id也会显示

设置为1,则表示，除了设置为1的这些域以外，其余的域值均不显示，只显示这些，但是_id还是会显示

但是可以这样设置，db.集合名.find({条件}，{_id:0,..:1,..:1}) 可以手动设置 _id为0，这是一个特殊情况，只有这种情况后面的域名条件不是全为0，或者全为1，因为 有 _id

当然还有findOne方法，意思是只得到查找到的第一条结果，由于集合中的文档是有序的，和插入顺序相关。

findOne也相当于mysql中的limit,后面的参数和find一样

find函数后面可以通过索引得到具体的那一条查询结果  find()[1]  获取查找结果中的第二项

query条件的不等于情况

2.比较运算符

上面写的是query条件的等于情况，可以用:来表示。只能得到=的条件

其实=也可以用$eq来表示，比如db.集合名.find({name:{$eq:'lucy'}}) 

:也可以为是的意思，这大致于name是等于lucy，或者name的条件是等于lucy

域名：{条件} 这是主要形式 直接用name:lucy相当于是省略了，间写了，但是对于其他条件来说就没办法简写

注意在mongo中{}和[]中都可以放多个键值对来表示多个条件，比如query中的{}可以放多个域需要的条件，而域名:{条件}  这里面的条件也可以放多个

比如db.集合名.find({name:{$eq:'lucy'},age:{$lt:45,$gt30}}) 表示查找条件为姓名为luck,年龄大于30小于45

用,默认隔开就是and的意思

$lt表示小于   后面再加e表示小于等于 

$gt表示大于  后面再加e表示大于等于

注意在mongo中字符串可以比大小，规则和python中的一样

$ne 表示不等于，注意当某个域名不存在时，但是条件用到了$ne，会把所有都显示出来

比如db.集合名.find({lk:{$ne:45}}) 整个集合中并没有一条记录的域名有'lk'，但是用到了$ne,也会把所有都显示出来，系统设计的不完善。

$in 表示在 ，包含关系 比如db.集合名.find({age:{$in:[17,18]}})  $nin表示不包含

3.逻辑运算符

且 $and 

在{}中','默认可以用来表示and的意思，db.集合名.find({name:{$eq:'lucy'},age:{$lt:45,$gt30}})

name和age之间的,意思默认是and，还有45与30

当然也可以用$and将他们连接起来，是正常的且操作

db.集合名.find({$and:[{name:{$eq:'lucy'}},{age:{$lt:45,$gt30}}]})

注意用$and连接，用[]将条件包裹住，条件还要用{}来包裹键值对，这样好在[]中分开

而默认的,表示and，只需要在一个大括号中包裹键值对，键值对不需要再用{}包含了，只是条件值需要用一下{}。

或 $or  这个就必须规规矩矩那样写

非 $not 这个是加在内部条件外一层的，比如说{name:{$not:{$lt:'lucy'}}} 加在了外面一层

$nor 非或  not (a or b)  相当于 not a and not b



4.数组类型

可以包含各种类型，用[]包裹

当我们想查询文档的时候，当需要通过域值为数组查询，比如文档中有score:[12,14,16]   想查询文档中score包含12,就可以直接这样 score:12 这样默认会查询出所有score中包含12的文档，当然也可以score:{$lt:13} 查询出所有score中有小于13的文档，只要包含这个条件，就会被查询出来

$all 用在数组查询里，可以查询出数组里包含想要几个值得文档

比如 score:{$all:[12,13]}  注意一般给多个值，都是用[]包裹的，键值对就用{}

$size 用在数组查询里，可以查询出给定元素个数的数组，一个数组中的元素个数等于这个数目，就会被查询出来

比如 score:{$size:3}

用在score数组的还有一个是显示条件，可以在后面的显示条件(相当于mysql select 后面的)里加score:{$slice:2}可以显示前两项，score:{$slice:[1,2]}  可以跳过第一项，显示后两项



5.其他查找操作符

$exists 表示文档是否存在某个域  后面接true,false

$mod 表示某个域的值 除多少能余多少，把符合条件的值找出来 比如 $mod:[2,0]  表示除二余0

$type 判断是哪个类型，可用数值代替类型，具体查看官方文档

记住，条件里只有域名，操作符后面能接:,操作符后面的:需要给多个值有时要[]   对于$not来说:后面还接{}



6.对于查找结果进行操作的函数

distinct函数，用于查找域名的值，也就是查看域里有哪些值，去重

比如db.集合名.distinct('域名')  显示整个集合某个域内有哪些值

对查找结果操作的函数：

pretty（） 让结果更好的显示  比如db.class0.find().pretty()

limit(n)  显示前n条结果

skip(n)  跳过前n条，显示后面的结果

sort排序，后面接条件，一样用{}围起来，域名后面接: ，1代表升序，-1代表降序,也可以多重排序

比如sort({name:1,age:-1})

count计数，可以将查询结果统计数量，记住一般count适合有条件的find，直接find()用conut计数可能会不准确

一般来说只要对结果都可以多重操作，比如sort后面再接limit



7.和find类似的remove函数

remove是删除记录，对集合进行。

remove(条件，设置) 条件和find中的条件一样，设置可不填，默认为false，删除所有满足条件的文档

也可以设置为true,只删除满足条件的第一条文档，因为文档是有顺序的

删除集合中所有文档 db.集合名.remove({}) 条件不给，默认就是删除所有

 